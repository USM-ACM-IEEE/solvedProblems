This is the peragrams solution on open kattis.

The problem statement can be found here:
https://open.kattis.com/problems/synchronizinglists